name: Push Release Notes to Beamer

on:
  workflow_dispatch

jobs:
  push-release-notes:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: "Call action"
        id: last_release
        uses: InsonusK/get-latest-release@v1.0.1
        with:
          myToken: ${{ secrets.MY_TOKEN }}
          exclude_types: "draft|prerelease"
          view_top: 1

      - name: "Get release description"
        id: release_description
        run: |
          release_id=${{ steps.last_release.outputs.id }}
          access_token=${{ secrets.MY_TOKEN }}
          description=$(curl -s -H "Authorization: token $access_token" \
                       "https://api.github.com/repos/${{ github.repository }}/releases/$release_id" | \
                       jq -r '.body')
          echo "DESCRIPTION=$description" >> $GITHUB_ENV

      - name: "Print result"
        run: |
          echo "tag_name: ${{ steps.last_release.outputs.tag_name }}"
          echo "description: $DESCRIPTION"
